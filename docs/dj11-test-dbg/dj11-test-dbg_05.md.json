["```py\nkmt@lbox:/dj_projects/marketr$ nosetests \nE \n====================================================================== \nERROR: Failure: ImportError (Settings cannot be imported, because environment variable DJANGO_SETTINGS_MODULE is undefined.) \n---------------------------------------------------------------------- \nTraceback (most recent call last): \n File \"/usr/lib/python2.5/site-packages/nose-0.11.1-py2.5.egg/nose/loader.py\", line 379, in loadTestsFromName \n addr.filename, addr.module) \n File \"/usr/lib/python2.5/site-packages/nose-0.11.1-py2.5.egg/nose/importer.py\", line 39, in importFromPath \n return self.importFromDir(dir_path, fqname) \n File \"/usr/lib/python2.5/site-packages/nose-0.11.1-py2.5.egg/nose/importer.py\", line 86, in importFromDir \n mod = load_module(part_fqname, fh, filename, desc) \n File \"/dj_projects/marketr/survey/tests/__init__.py\", line 1, in <module> \n from model_tests import * \n File \"/dj_projects/marketr/survey/tests/model_tests.py\", line 2, in <module> \n from django.test import TestCase \n File \"/usr/lib/python2.5/site-packages/django/test/__init__.py\", line 5, in <module> \n from django.test.client import Client \n File \"/usr/lib/python2.5/site-packages/django/test/client.py\", line 24, in <module> \n from django.db import transaction, close_connection \n File \"/usr/lib/python2.5/site-packages/django/db/__init__.py\", line 10, in <module> \n if not settings.DATABASE_ENGINE: \n File \"/usr/lib/python2.5/site-packages/django/utils/functional.py\", line 269, in __getattr__ \n self._setup() \n File \"/usr/lib/python2.5/site-packages/django/conf/__init__.py\", line 38, in _setup \n raise ImportError(\"Settings cannot be imported, because environment variable %s is undefined.\" % ENVIRONMENT_VARIABLE) \nImportError: Settings cannot be imported, because environment variable DJANGO_SETTINGS_MODULE is undefined. \n\n---------------------------------------------------------------------- \nRan 1 test in 0.007s \n\nFAILED (errors=1) \n\n```", "```py\ndef run_tests(test_labels, verbosity=1, interactive=True, extra_tests=[]):  \n    \"\"\" \n    Run the unit tests for all the test labels in the provided list. \n    Labels must be of the form: \n     - app.TestClass.test_method \n        Run a single specific test method \n     - app.TestClass \n        Run all the test methods in a given class \n     - app \n        Search for doctests and unittests in the named application. \n\n    When looking for tests, the test runner will look in the models and tests modules for the application. \n\n    A list of 'extra' tests may also be provided; these tests \n    will be added to the test suite. \n\n    Returns the number of tests that failed. \n    \"\"\" \n```", "```py\nfrom django.core.management.base import BaseCommand \nfrom optparse import make_option \nimport sys \n\nclass Command(BaseCommand): \n    option_list = BaseCommand.option_list + ( \n        make_option('--noinput', action='store_false', dest='interactive', default=True, \n            help='Tells Django to NOT prompt the user for ''input of any kind.'), \n    ) \n    help = 'Runs the test suite for the specified applications, or '\\ 'the entire site if no apps are specified.' \n    args = '[appname ...]' \n\n    requires_model_validation = False \n```", "```py\n     option_list = BaseCommand.option_list + (\n        make_option('--noinput', action='store_false',\n            dest='interactive', default=True,\n            help='Tells Django to NOT prompt the user for '\n                'input of any kind.'),\n        make_option('--cover', action='store_true',\n            dest='coverage', default=False,\n            help='Tells Django to generate test coverage data.'),\n    ) \n```", "```py\n    def handle(self, *test_labels, **options): \n        from django.conf import settings \n        from django.test.utils import get_runner \n\n        verbosity = int(options.get('verbosity', 1)) \n        interactive = options.get('interactive', True) \n        test_runner = get_runner(settings) \n\n        failures = test_runner(test_labels, verbosity=verbosity,  interactive=interactive) \n        if failures: \n            sys.exit(failures) \n```", "```py\n        coverage = options.get('coverage', False) \n        print 'Here we do our own thing instead of calling the test '\\\n            'runner.' \n        if coverage: \n            print 'Our new cover option HAS been specified.' \n        else: \n            print 'Our new cover option HAS NOT been specified.' \n```", "```py\nkmt@lbox:/dj_projects/marketr$ python manage.py survey_test --cover \nHere we do our own thing instead of calling the test runner. \nOur new cover option HAS been specified.\n\n```", "```py\nkmt@lbox:/dj_projects/marketr$ python manage.py survey_test \nHere we do our own thing instead of calling the test runner. \nOur new cover \noption HAS NOT been specified. \n\n```", "```py\nkmt@lbox:/dj_projects/marketr$ python manage.py survey_test --help \nUsage: manage.py survey_test [options] [appname ...] \n\nRuns the test suite for the specified applications, or the entire site if no apps are specified. \n\nOptions: \n -v VERBOSITY, --verbosity=VERBOSITY \n Verbosity level; 0=minimal output, 1=normal output, \n 2=all output \n --settings=SETTINGS   The Python path to a settings module, e.g. \n \"myproject.settings.main\". If this isn't provided, the \n DJANGO_SETTINGS_MODULE environment variable will be used. \n --pythonpath=PYTHONPATH \n A directory to add to the Python path, e.g. \n \"/home/djangoprojects/myproject\". \n --traceback           Print traceback on exception \n --noinput             Tells Django to NOT prompt the user for input of any kind. \n --cover               Tells Django to generate test coverage data. \n --version             show program's version number and exit \n -h, --help            show this help message and exit \n\n```", "```py\nkmt@lbox:/dj_projects/marketr$ coverage run manage.py test survey \nCreating test database... \nCreating table auth_permission \nCreating table auth_group \nCreating table auth_user \nCreating table auth_message \nCreating table django_content_type \nCreating table django_session \nCreating table django_site \nCreating table django_admin_log \nCreating table survey_survey \nCreating table survey_question \nCreating table survey_answer \nInstalling index for auth.Permission model \nInstalling index for auth.Message model \nInstalling index for admin.LogEntry model \nInstalling index for survey.Question model \nInstalling index for survey.Answer model \n..................... \n---------------------------------------------------------------------- \nRan 21 tests in 11.361s \n\nOK \nDestroying test database... \n\n```", "```py\nkmt@lbox:/dj_projects/marketr$ coverage report\nName                                                 Stmts   Exec  Cover \n------------------------------------------------------------------------- \n/usr/share/pyshared/mod_python/__init__                   2      2   100% \n/usr/share/pyshared/mod_python/util                     330      1     0% \n/usr/share/pyshared/mx/TextTools/Constants/Sets          42     42   100% \n/usr/share/pyshared/mx/TextTools/Constants/TagTables     12     12   100% \n/usr/share/pyshared/mx/TextTools/Constants/__init__      1      1   100% \n/usr/share/pyshared/mx/TextTools/TextTools              259     47    18% \n/usr/share/pyshared/mx/TextTools/__init__                27     18    66% \n/usr/share/pyshared/mx/TextTools/mxTextTools/__init__    12      9    75% \n/usr/share/pyshared/mx/__init__                          2      2   100% \n/usr/share/pyshared/pysqlite2/__init__                  1      1   100% \n/usr/share/pyshared/pysqlite2/dbapi2               41     26    63% \n/usr/share/python-support/python-simplejson/simplejson/__init__      75     20    26% \n/usr/share/python-support/python-simplejson/simplejson/decoder      208    116    55% \n/usr/share/python-support/python-simplejson/simplejson/encoder      215     40    18% \n/usr/share/python-support/python-simplejson/simplejson/scanner       51     46    90% \n__init__                                                1      1   100% \nmanage                                                 9      5    55% \nsettings                                                 23     23   100% \nsurvey/__init__                                             1      1   100% \nsurvey/admin                                                         24     24   100% \nsurvey/models                                                        38     37    97% \nsurvey/tests/__init__                                                 4      4   100% \nsurvey/tests/admin_tests                                             23     23   100% \nsurvey/tests/model_tests                                             98     86    87% \nsurvey/tests/view_tests                                              47     47   100% \nsurvey/urls                                                           2      2   100% \nsurvey/views                                                         22     22   100% \nurls                                                                  4      4   100% \n------------------------------------------------------------------------------------- \nTOTAL                                                              1575    663    42% \n\n```", "```py\nkmt@lbox:/dj_projects/marketr$ coverage report --omit /usr -m \nName                       Stmts   Exec  Cover   Missing \n-------------------------------------------------------- \n__init__                       1      1   100% \nmanage                         9      5    55%   5-8 \nsettings                      23     23   100% \nsurvey/__init__                1      1   100% \nsurvey/admin                  24     24   100% \nsurvey/models                 38     37    97%   66\nsurvey/tests/__init__          4      4   100% \nsurvey/tests/admin_tests      23     23   100% \nsurvey/tests/model_tests      98     86    87%   35-42, 47-51 \nsurvey/tests/view_tests       47     47   100% \nsurvey/urls                    2      2   100% \nsurvey/views                  23     23   100% \nurls                           4      4   100% \n-------------------------------------------------------- \nTOTAL                        297    280    94% \n\n```", "```py\n        if settings.DATABASE_ENGINE == 'mysql': \n            from django.db import connection \n            c = connection.cursor() \n            c.execute('SELECT @@SESSION.sql_mode') \n            mode = c.fetchone()[0] \n            if 'STRICT' not in mode: \n                strict = False; \n                from django.utils import importlib \n                debug = importlib.import_module(\n                    settings.SETTINGS_MODULE).DEBUG \n\n        if strict: \n            self.assertRaises(IntegrityError, s.save) \n        elif debug: \n            self.assertRaises(Exception, s.save) \n        else: \n            s.save() \n            self.assertEqual(s.closes, None) \n```", "```py\nTEST_RUNNER = 'django_coverage.coverage_runner.run_tests' \n```", "```py\n---------------------------------------------------------------------- \nRan 21 tests in 10.040s \n\nOK \nDestroying test database... \nName            Stmts   Exec  Cover   Missing \n--------------------------------------------- \nsurvey.admin       21     21   100% \nsurvey.models      30     30   100% \nsurvey.views       18     18   100% \n--------------------------------------------- \nTOTAL              69     69   100% \n\nThe following packages or modules were excluded: survey.__init__ survey.tests survey.urls\n\nThere were problems with the following packages or modules: survey.templates survey.fixtures \n\n```", "```py\nCOVERAGE_MODULE_EXCLUDES = ['tests$', 'settings$', 'urls$',\n                            'common.views.test', '__init__', 'django',\n                            'migrations', 'fixtures$', 'templates$']\n```", "```py\nCOVERAGE_REPORT_HTML_OUTPUT_DIR = '/dj_projects/marketr/coverage_html'\n```", "```py\npython manage.py test_coverage survey.AdminSurveyTest.testAddSurveyError\n\n```", "```py\nRan 1 test in 0.337s\n\nOK\nDestroying test database...\n\nHTML reports were output to '/dj_projects/marketr/coverage_html'\n\n```", "```py\n    def testAddSurveyError(self): \n        post_data = { \n            'title': u'Time Traveling', \n            'opens': datetime.date.today(), \n            'closes': datetime.date.today() - datetime.timedelta(1), \n            'question_set-TOTAL_FORMS': u'0', \n            'question_set-INITIAL_FORMS': u'0', \n        } \n        response = self.client.post(\n            reverse('admin:survey_survey_add'), post_data) \n        self.assertContains(response,\"Opens date cannot come after closes date.\") \n```", "```py\nkmt@lbox:~$ twill-sh \n\n -= Welcome to twill! =- \n\ncurrent page:  *empty page* \n>> go http://localhost:8000/admin/survey/survey/add/ \n==> at http://localhost:8000/admin/survey/survey/add/ \ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>> showforms \n\nForm #1 \n## ## __Name__________________ __Type___ __ID________ __Value____________\n1     username                 text      id_username \n2     password                 password  id_password \n3     this_is_the_login_form   hidden    (None)       1 \n4  1  None                     submit    (None)       Log in \n\ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>> \n\n```", "```py\n>> formvalue 1 username kmt \ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>> formvalue 1 password secret\ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>> \n\n```", "```py\n>> submit \nNote: submit is using submit button: name=\"None\", value=\"Log in\" \n\ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n\n```", "```py\n>> showforms \n\nForm #1 \n## ## __Name__________________ __Type___ __ID________ __Value____________\n1     title                    text      id_title \n2     opens                    text      id_opens \n3     closes                   text      id_closes \n4     question_set-TOTAL_FORMS hidden    id_quest ... 4 \n5     question_set-INITIAL ... hidden    id_quest ... 0 \n6     question_set-0-id        hidden    id_quest ... \n7     question_set-0-survey    hidden    id_quest ... \n8     question_set-0-question  text      id_quest ... \n9     question_set-1-id        hidden    id_quest ... \n10    question_set-1-survey    hidden    id_quest ... \n11    question_set-1-question  text      id_quest ... \n12    question_set-2-id        hidden    id_quest ... \n13    question_set-2-survey    hidden    id_quest ... \n14    question_set-2-question  text      id_quest ... \n15    question_set-3-id        hidden    id_quest ... \n16    question_set-3-survey    hidden    id_quest ... \n17    question_set-3-question  text      id_quest ... \n18 1  _save                    submit    (None)       Save \n19 2  _addanother              submit    (None)       Save and add another \n20 3  _continue                submit    (None)       Save and continue editing \n\ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>> \n\n```", "```py\n>> formvalue 1 title 'Time Traveling' \ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>> formvalue 1 opens 2009-08-15 \ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>> formvalue 1 closes 2009-08-01 \ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n\n```", "```py\n>> submit \nNote: submit is using submit button: name=\"_save\", value=\"Save\" \n\ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>> find \"Opens date cannot come after closes date.\" \ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>>\n\n```", "```py\n>> find \"lalalala I don't hear you\" \n\nERROR: no match to 'lalalala I don't hear you' \n\ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>> \n\n```", "```py\n>> showforms \n\nForm #1 \n## ## __Name__________________ __Type___ __ID________ __Value________________\n1     title                    text      id_title     Time Traveling \n2     opens                    text      id_opens     2009-08-15 \n3     closes                   text      id_closes    2009-08-01 \n4     question_set-TOTAL_FORMS hidden    id_quest ... 4 \n5     question_set-INITIAL ... hidden    id_quest ... 0 \n6     question_set-0-id        hidden    id_quest ... \n7     question_set-0-survey    hidden    id_quest ... \n8     question_set-0-question  text      id_quest ... \n9     question_set-1-id        hidden    id_quest ... \n10    question_set-1-survey    hidden    id_quest ... \n11    question_set-1-question  text      id_quest ... \n12    question_set-2-id        hidden    id_quest ... \n13    question_set-2-survey    hidden    id_quest ... \n14    question_set-2-question  text      id_quest ... \n15    question_set-3-id        hidden    id_quest ... \n16    question_set-3-survey    hidden    id_quest ... \n17    question_set-3-question  text      id_quest ... \n18 1  _save                    submit    (None)       Save \n19 2  _addanother              submit    (None)     Save and add another \n20 3  _continue                submit    (None)     Save and continue editing \n\ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>>\n\n```", "```py\n>> formvalue 1 opens 2009-07-15 \ncurrent page: http://localhost:8000/admin/survey/survey/add/ \n>> submit \nNote: submit is using submit button: name=\"_save\", value=\"Save\" \n\ncurrent page: http://localhost:8000/admin/survey/survey/ \n>> \n\n```", "```py\nfrom django.core.handlers.wsgi import WSGIHandler \nimport twill \nTWILL_TEST_HOST = 'twilltest'   \ntwill.add_wsgi_intercept(TWILL_TEST_HOST, 80, WSGIHandler) \n```", "```py\ndef reverse_for_twill(named_url): \n    return 'http://' + TWILL_TEST_HOST + reverse(named_url) \n```", "```py\nclass AdminSurveyTest(TestCase):\n    def setUp(self):\n        self.username = 'survey_admin'\n        self.pw = 'pwpwpw'\n        self.user = User.objects.create_user(self.username, '', \" \"self.pw)\n        self.user.is_staff= True\n        self.user.is_superuser = True\n        self.user.save()\n        self.assertTrue(self.client.login(username=self.username, password=self.pw),\n            \"Logging in user %s, pw %s failed.\" % (self.username, self.pw))\n```", "```py\nfrom django.db import close_connection\nfrom django.core import signals\nfrom django.core.handlers.wsgi import WSGIHandler \nfrom django.conf import settings\nimport twill \n\nclass AdminSurveyTwillTest(AdminTest): \n    def setUp(self): \n        super(AdminSurveyTwillTest, self).setUp() \n        self.old_propagate = settings.DEBUG_PROPAGATE_EXCEPTIONS\n        settings.DEBUG_PROPAGATE_EXCEPTIONS = True\n        signals.request_finished.disconnect(close_connection)\n        twill.add_wsgi_intercept(TWILL_TEST_HOST, 80, WSGIHandler) \n        self.browser = twill.get_browser() \n        self.browser.go(reverse_for_twill('admin:index')) \n        twill.commands.formvalue(1, 'username', self.username) \n        twill.commands.formvalue(1, 'password', self.pw) \n        self.browser.submit() \n        twill.commands.find('Welcome') \n```", "```py\n    def tearDown(self): \n        self.browser.go(reverse_for_twill('admin:logout')) \n        twill.remove_wsgi_intercept(TWILL_TEST_HOST, 80)\n        signals.request_finished.connect(close_connection) \n        settings.DEBUG_PROPAGATE_EXCEPTIONS = self.old_propagate \n```", "```py\n    def testAddSurveyError(self): \n        self.browser.go(reverse_for_twill('admin:survey_survey_add')) \n        twill.commands.formvalue(1, 'title', 'Time Traveling') \n        twill.commands.formvalue(1, 'opens', str(datetime.date.today())) \n         twill.commands.formvalue(1, 'closes',\n            str(datetime.date.today()-datetime.timedelta(1)))\n        self.browser.submit()\n        twill.commands.url(reverse_for_twill(\n            'admin:survey_survey_add'))\n        twill.commands.find(\"Opens date cannot come after closes \"\n            \"date.\") \n```", "```py\nInstalling index for survey.Answer model \n==> at http://twilltest/admin/ \nNote: submit is using submit button: name=\"None\", value=\"Log in\" \n\n==> at http://twilltest/admin/survey/survey/add/ \nNote: submit is using submit button: name=\"_save\", value=\"Save\" \n\n==> at http://twilltest/admin/logout/ \n. \n---------------------------------------------------------------------- \nRan 1 test in 0.845s \n\nOK \nDestroying test database... \n\n```", "```py\n        twill.set_output(StringIO())\n```", "```py\n    def testAddSurveyOK(self): \n        self.browser.go(reverse_for_twill('admin:survey_survey_add')) \n        twill.commands.formvalue(1, 'title', 'Not Time Traveling') \n        twill.commands.formvalue(1, 'opens', str(datetime.date.today())) \n        twill.commands.formvalue(1, 'closes', str(datetime.date.today())) \n        self.browser.submit() \n        twill.commands.url(reverse_for_twill('admin:survey_survey_changelist'))\n```", "```py\ntwill.commands.url(reverse_for_twill('admin:survey_survey_changelist') + '$') \n```", "```py\n====================================================================== \nERROR: testAddSurveyOK (survey.tests.admin_tests.AdminSurveyTwillTest) \n---------------------------------------------------------------------- \nTraceback (most recent call last): \n File \"/dj_projects/marketr/survey/tests/admin_tests.py\", line 91, in testAddSurveyOK \n twill.commands.url(reverse_for_twill('admin:survey_survey_changelist') + '$') \n File \"/usr/lib/python2.5/site-packages/twill/commands.py\", line 178, in url \n \"\"\" % (current_url, should_be,)) \nTwillAssertionError: current url is 'http://twilltest/admin/survey/survey/add/'; \ndoes not match 'http://twilltest/admin/survey/survey/$' \n\n---------------------------------------------------------------------- \nRan 2 tests in 1.349s \n\nFAILED (errors=1) \nDestroying test database... \n\n```"]