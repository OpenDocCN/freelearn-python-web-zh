["```py\n{\n    \"Mashape_API_Endpoint\" : \"https://andruxnet-random-famous-quotes.p.mashape.com/\",\n    \"X_Mashape_Key\": \"XXXXXXXXXXXXXXXXXXXXXXXXXXXX\"\n}\n```", "```py\n{\n    \"dev\": {\n        ...\n        \"remote_env\": \"s3://book-configs/chapter-11-config.json\"\n        ...\n    }\n}\n```", "```py\n$ export Mashape_API_Endpoint=https://andruxnet-random-famous-quotes.p.mashape.com/\n$ export X_Mashape_Key=XXXXXXXXXXXXXXXXXX\n```", "```py\nimport os\nimport requests\n\ndef fetch_quote():\n    response = requests.get(\n        os.environ.get('Mashape_API_Endpoint'),\n        headers={\n            'X-Mashape-Key': os.environ.get('X_Mashape_Key'),\n            'Accept': 'application/json'\n        }\n    )\n    if response.status_code == 200:\n        return response.json()[0]\n    return response.json() \n```", "```py\nimport falcon\nfrom mashape import fetch_quote\n\nclass RandomQuoteResource:\n    def on_get(self, req, resp):\n        \"\"\"Handles GET requests\"\"\"\n        try:\n            resp.media = fetch_quote()\n        except Exception as e:\n            raise falcon.HTTPError(falcon.HTTP_500, str(e))\n\napi = falcon.API()\napi.add_route('/', RandomQuoteResource())\n```", "```py\n$ gunicorn resources:api\n[2018-07-11 13:59:28 +0530] [3562] [INFO] Starting gunicorn 19.9.0\n[2018-07-11 13:59:28 +0530] [3562] [INFO] Listening at: http://127.0.0.1:8000 (3562)\n[2018-07-11 13:59:28 +0530] [3562] [INFO] Using worker: sync\n[2018-07-11 13:59:28 +0530] [3565] [INFO] Booting worker with pid: 3565\n```", "```py\n$ curl http://localhost:8000\n{\"quote\": \"Whenever I climb I am followed by a dog called 'Ego'.\", \"author\": \"Friedrich Nietzsche\", \"category\": \"Famous\"}\n```", "```py\n{\n    \"dev\": {\n        \"app_function\": \"resources.api\",\n        \"profile_name\": \"default\",\n        \"project_name\": \"chapter11\",\n        \"runtime\": \"python3.6\",\n        \"s3_bucket\": \"zappa-ss0sm7k4r\"\n    }\n}\n```", "```py\n$ zappa deploy dev\nCalling deploy for stage dev..\nCreating chapter11-dev-ZappaLambdaExecutionRole IAM Role..\nCreating zappa-permissions policy on chapter11-dev-ZappaLambdaExecutionRole IAM Role.\nDownloading and installing dependencies..\n - sqlite==python36: Using precompiled lambda package\nPackaging project as zip.\nUploading chapter11-dev-1531293742.zip (5.6MiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5.92M/5.92M [00:02<00:00, 1.16MB/s]\nScheduling..\nScheduled chapter11-dev-zappa-keep-warm-handler.keep_warm_callback with expression rate(4 minutes)!\nUploading chapter11-dev-template-1531293760.json (1.6KiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1.62K/1.62K [00:00<00:00, 2.32KB/s]\nWaiting for stack chapter11-dev to create (this can take a bit)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 4/4 [00:09<00:00, 2.67s/res]\nDeploying API Gateway..\nScheduling..\nUnscheduled chapter11-dev-zappa-keep-warm-handler.keep_warm_callback.\nScheduled chapter11-dev-zappa-keep-warm-handler.keep_warm_callback with expression rate(4 minutes)!\nYour updated Zappa deployment is live!: https://u1pao12esc.execute-api.ap-south-1.amazonaws.com/dev\n\n```", "```py\n{\n    \"dev\": {\n        \"app_function\": \"resources.api\",\n        \"profile_name\": \"default\",\n        \"project_name\": \"chapter11\",\n        \"runtime\": \"python3.6\",\n        \"s3_bucket\": \"zappa-ss0sm7k4r\",\n        \"remote_env\": \"s3://book-configs/chapter-11-config.json\",\n \"domain\": \"random-quote.abdulwahid.info\",\n \"certificate_arn\":\"arn:aws:acm:us-east-1:042373950390:certificate/af0796fa-3a46-49ae-97d8-90a6b5ff6784\"\n    }\n}\n```", "```py\nzappa update command:\n```", "```py\n$ zappa update dev\nCalling update for stage dev..\nDownloading and installing dependencies..\n - sqlite==python36: Using precompiled lambda package\nPackaging project as zip.\nUploading chapter11-dev-1531294072.zip (5.6MiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5.92M/5.92M [00:02<00:00, 2.19MB/s]\nUpdating Lambda function code..\nUpdating Lambda function configuration..\nUploading chapter11-dev-template-1531294078.json (1.6KiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1.62K/1.62K [00:00<00:00, 8.55KB/s]\nDeploying API Gateway..\nScheduling..\nUnscheduled chapter11-dev-zappa-keep-warm-handler.keep_warm_callback.\nScheduled chapter11-dev-zappa-keep-warm-handler.keep_warm_callback with expression rate(4 minutes)!\nYour updated Zappa deployment is live!: https://random-quote.abdulwahid.info (https://u1pao12esc.execute-api.ap-south-1.amazonaws.com/dev)\n```", "```py\nzappa certify command:\n```", "```py\n$ zappa certify dev\nCalling certify for stage dev..\nAre you sure you want to certify? [y/n] y\nCertifying domain random-quote.abdulwahid.info..\nCreated a new domain name with supplied certificate. Please note that it can take up to 40 minutes for this domain to be created and propagated through AWS, but it requires no further work on your part.\nCertificate updated!\n```", "```py\n$ curl https://random-quote.abdulwahid.info\n{\"quote\": \"The significant problems we face cannot be solved at the same level of thinking we were at when we created them.\", \"author\": \"Albert Einstein\", \"category\": \"Famous\"}\n```", "```py\nzappa_settings.json file with the \"api_key_required\" attribute.\n```", "```py\n{\n    \"dev\": {\n        \"app_function\": \"resources.api\",\n        \"profile_name\": \"default\",\n        \"project_name\": \"chapter11\",\n        \"runtime\": \"python3.6\",\n        \"s3_bucket\": \"zappa-ss0sm7k4r\",\n        \"remote_env\": \"s3://book-configs/chapter-11-config.json\",\n        \"domain\": \"random-quote.abdulwahid.info\",\n        \"certificate_arn\":\"arn:aws:acm:us-east-1:042373950390:certificate/af0796fa-3a46-49ae-97d8-90a6b5ff6784\",\n \"api_key_required\": true\n    }\n}\n```", "```py\n$ zappa deploy dev\nCalling deploy for stage dev..\nDownloading and installing dependencies..\n - sqlite==python36: Using precompiled lambda package\nPackaging project as zip.\nUploading chapter11-dev-1531334904.zip (5.6MiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5.92M/5.92M [00:12<00:00, 360KB/s]\nScheduling..\nScheduled chapter11-dev-zappa-keep-warm-handler.keep_warm_callback with expression rate(4 minutes)!\nUploading chapter11-dev-template-1531334920.json (1.6KiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1.61K/1.61K [00:00<00:00, 10.4KB/s]\nWaiting for stack chapter11-dev to create (this can take a bit)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 4/4 [00:09<00:00, 4.69s/res]\nDeploying API Gateway..\nCreated a new x-api-key: zp0snz9tik\nDeployment complete!: https://laqdydyrg3.execute-api.ap-south-1.amazonaws.com/dev\n```", "```py\n{\n    \"dev\": {\n        \"app_function\": \"resources.api\",\n        \"profile_name\": \"default\",\n        \"project_name\": \"chapter11\",\n        \"runtime\": \"python3.6\",\n        \"s3_bucket\": \"zappa-ss0sm7k4r\",\n        \"remote_env\": \"s3://book-configs/chapter-11-config.json\",\n        \"domain\": \"random-quote.abdulwahid.info\",\n        \"certificate_arn\":\"arn:aws:acm:us-east-1:042373950390:certificate/af0796fa-3a46-49ae-97d8-90a6b5ff6784\",\n        \"api_key_required\": true,\n\"api_key\":\"yEddw9WeMH2UIZXHcaHQb1WvbindovrB55Rf4eAW\"\n    }\n}\n```", "```py\n$ zappa update dev\nCalling update for stage dev..\nDownloading and installing dependencies..\n - sqlite==python36: Using precompiled lambda package\nPackaging project as zip.\nUploading chapter11-dev-1531337694.zip (5.6MiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5.92M/5.92M [00:16<00:00, 261KB/s]\nUpdating Lambda function code..\nUpdating Lambda function configuration..\nUploading chapter11-dev-template-1531337713.json (1.6KiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1.61K/1.61K [00:00<00:00, 8.50KB/s]\nDeploying API Gateway..\nScheduling..\nUnscheduled chapter11-dev-zappa-keep-warm-handler.keep_warm_callback.\nScheduled chapter11-dev-zappa-keep-warm-handler.keep_warm_callback with expression rate(4 minutes)!\nYour updated Zappa deployment is live!: https://random-quote.abdulwahid.info (https://laqdydyrg3.execute-api.ap-south-1.amazonaws.com/dev)\n```", "```py\n$ curl https://random-quote.abdulwahid.info/\n{\"message\":\"Forbidden\"}\n```", "```py\n$ curl --header \"x-api-key: yEddw9WeMH2UIZXHcaHQb1WvbindovrB55Rf4eAW\" https://random-quote.abdulwahid.info/\n{\"quote\": \"Problems worthy of attack prove their worth by fighting back.\", \"author\": \"Paul Erdos\", \"category\": \"Famous\"}\n```", "```py\n{\n    \"dev\": {\n        \"app_function\": \"resources.api\",\n        \"profile_name\": \"default\",\n        \"project_name\": \"chapter11\",\n        \"runtime\": \"python3.6\",\n        \"s3_bucket\": \"zappa-ss0sm7k4r\",\n        \"remote_env\": \"s3://book-configs/chapter-11-config.json\",\n        \"domain\": \"random-quote.abdulwahid.info\",\n        \"certificate_arn\":\"arn:aws:acm:us-east-1:042373950390:certificate/af0796fa-3a46-49ae-97d8-90a6b5ff6784\",\n        \"api_key_required\": true,\n        \"api_key\":\"yEddw9WeMH2UIZXHcaHQb1WvbindovrB55Rf4eAW\"\n    },\n    \"dev_iam\": {\n \"app_function\": \"resources.api\",\n \"profile_name\": \"default\",\n \"project_name\": \"chapter11\",\n \"runtime\": \"python3.6\",\n \"s3_bucket\": \"zappa-ss0sm7k4r\",\n \"remote_env\": \"s3://book-configs/chapter-11-config.json\",\n \"domain\": \"random-quote-iam.abdulwahid.info\",\n \"certificate_arn\":\"arn:aws:acm:us-east-1:042373950390:certificate/af0796fa-3a46-49ae-97d8-90a6b5ff6784\",\n \"iam_authorization\": true\n }\n}\n```", "```py\ncurl execution:\n```", "```py\n$ curl -s -w \"\\nStatus Code:%{http_code}\" https://random-quote-iam.abdulwahid.info\n{\"message\":\"Missing Authentication Token\"}\nStatus Code:403\n```", "```py\nimport os\nimport requests\nfrom requests_aws_sign import AWSV4Sign\nfrom boto3 import session\n\n# You must provide a credentials object as per http://boto3.readthedocs.io/en/latest/guide/configuration.html#configuring-credentials\n# This example attempts to get credentials based upon the local environment\n# e.g. Environment Variables, assume role profiles, EC2 Instance IAM profiles\nsession = session.Session(\n    aws_access_key_id=os.environ['aws_access_key_id'],\n    aws_secret_access_key=os.environ['aws_secret_access_key'])\ncredentials = session.get_credentials()\n\n# You must provide an AWS region\nregion = session.region_name or 'ap-south-1'\n\n# You must provide the AWS service. E.g. 'es' for Elasticsearch, 's3' for S3, etc.\nservice = 'execute-api'\n\nurl = \"https://random-quote-iam.abdulwahid.info/\"\nauth=AWSV4Sign(credentials, region, service)\nresponse = requests.get(url, auth=auth)\n\nprint (response.content)\n```", "```py\n$ python aws_sign_request_test.py \nb'{\"quote\": \"Many wealthy people are little more than janitors of their possessions.\", \"author\": \"Frank Lloyd Wright\", \"category\": \"Famous\"}'\n```", "```py\n{\n    \"dev\" : {\n        ...\n        \"authorizer\": {\n            \"function\": \"your_module.your_auth_function\", \n            \"arn\": \"arn:aws:lambda:<region>:<account_id>:function:<function_name>\",\n            \"result_ttl\": 300,\n            \"token_header\": \"Authorization\", // Optional. Default 'Authorization'. The name of a custom authorization header containing the token that clients submit as part of their requests.\n            \"validation_expression\": \"^Bearer \\\\w+$\", // Optional. A validation expression for the incoming token, specify a regular expression.\n        }\n        ...\n    }\n}\n```", "```py\n{\n    \"Code\": {\n        \"ZipFile\": blob,\n        \"S3Bucket\": \u201cstring\u201d,\n        \"S3Key\": \u201cstring\u201d,\n        \"S3ObjectVersion\": \u201cstring\u201d\n    },\n    \"Description\": \"string\",\n    \"FunctionName\": \"string\",\n    \"Handler\": \"string\",\n    \"MemorySize\": number,\n    \"Role\": \"string\",\n    \"Runtime\": \"string\",\n    \"Timeout\": number\n    \"Publish\": bool,\n    \"DeadLetterConfig\": {\n \"TargetArn\": \"string\" \n }\n} \n```", "```py\n{\n    \"dev\": {\n        \"app_function\": \"resources.api\",\n        \"profile_name\": \"default\",\n        \"project_name\": \"chapter11\",\n        \"runtime\": \"python3.6\",\n        \"s3_bucket\": \"zappa-ss0sm7k4r\",\n        \"remote_env\": \"s3://book-configs/chapter-11-config.json\",\n        \"domain\": \"random-quote.abdulwahid.info\",\n        \"certificate_arn\":\"arn:aws:acm:us-east-1:042373950390:certificate/af0796fa-3a46-49ae-97d8-90a6b5ff6784\",\n        \"api_key_required\": true,\n        \"api_key\":\"yEddw9WeMH2UIZXHcaHQb1WvbindovrB55Rf4eAW\",\n        \"dead_letter_arn\": \"arn:aws:sns:ap-south-1:042373950390:UnhandledException\"\n    },\n    \"dev_iam\": {\n        \"app_function\": \"resources.api\",\n        \"profile_name\": \"default\",\n        \"project_name\": \"chapter11\",\n        \"runtime\": \"python3.6\",\n        \"s3_bucket\": \"zappa-ss0sm7k4r\",\n        \"remote_env\": \"s3://book-configs/chapter-11-config.json\",\n        \"domain\": \"random-quote-iam.abdulwahid.info\",\n        \"certificate_arn\":\"arn:aws:acm:us-east-1:042373950390:certificate/af0796fa-3a46-49ae-97d8-90a6b5ff6784\",\n        \"iam_authorization\": true\n    }\n}\n```", "```py\nimport falcon\nfrom zappa.async import task\nfrom mashape import fetch_quote\n\nclass RandomQuoteResource:\n    def on_get(self, req, resp):\n        \"\"\"Handles GET requests\"\"\"\n        try:\n            resp.media = fetch_quote()\n        except Exception as e:\n            raise falcon.HTTPError(falcon.HTTP_500, str(e))\n\n@task\ndef async_task():\n    raise ValueError(\"Async Failure Exception\")\n\nclass AsyncTaskResource:\n    def on_get(self, req, resp):\n        \"\"\"Handles GET requests\"\"\"\n        try:\n            async_task()\n            resp.media = 'Called async task'\n        except Exception as e:\n            raise falcon.HTTPError(falcon.HTTP_500, strsk(e))\n\napi = falcon.API()\napi.add_route('/', RandomQuoteResource())\napi.add_route('/async-failure', AsyncTaskResource())\n```", "```py\nasync-failure\u00a0API:\n```", "```py\n$ curl -H \"x-api-key: yEddw9WeMH2UIZXHcaHQb1WvbindovrB55Rf4eAW\" https://random-quote.abdulwahid.info/async-failure\n\"Called async task\"\n```", "```py\n{\n    ...\n    \"dev_xray\": {\n        \"app_function\": \"resources.api\",\n        \"profile_name\": \"default\",\n        \"project_name\": \"chapter11\",\n        \"runtime\": \"python3.6\",\n        \"s3_bucket\": \"zappa-ss0sm7k4r\",\n        \"remote_env\": \"s3://book-configs/chapter-11-config.json\",\n        \"xray_tracing\": true\n    }\n}\n```", "```py\ndeploy command:\n```", "```py\n$ zappa deploy dev_xray\nCalling deploy for stage dev_xray..\nCreating chapter11-dev-xray-ZappaLambdaExecutionRole IAM Role..\nCreating zappa-permissions policy on chapter11-dev-xray-ZappaLambdaExecutionRole IAM Role.\nDownloading and installing dependencies..\n - lazy-object-proxy==1.3.1: Using locally cached manylinux wheel\n - sqlite==python36: Using precompiled lambda package\nPackaging project as zip.\nUploading chapter11-dev-xray-1531691356.zip (8.2MiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 8.65M/8.65M [00:19<00:00, 460KB/s]\nScheduling..\nScheduled chapter11-dev-xray-zappa-keep-warm-handler.keep_warm_callback with expression rate(4 minutes)!\nUploading chapter11-dev-xray-template-1531691381.json (1.6KiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1.64K/1.64K [00:00<00:00, 9.68KB/s]\nWaiting for stack chapter11-dev-xray to create (this can take a bit)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 4/4 [00:09<00:00, 4.70s/res]\nDeploying API Gateway..\nDeployment complete!: https://r0wagu3zh3.execute-api.ap-south-1.amazonaws.com/dev_xray\n```", "```py\n$ curl https://r0wagu3zh3.execute-api.ap-south-1.amazonaws.com/dev_xray\n{\"quote\": \"A lie gets halfway around the world before the truth has a chance to get its pants on.\", \"author\": \"Sir Winston Churchill\", \"category\": \"Famous\"}\n```", "```py\n{\n    ...\n    \"vpc_config\": { \n        \"SubnetIds\": [ \"subnet-12345678\" ],\n        \"SecurityGroupIds\": [ \"sg-12345678\" ]\n    },\n    ...\n}\n```", "```py\n{\n    ...,\n    \"dev_vpc\": {\n        \"app_function\": \"resources.api\",\n        \"profile_name\": \"default\",\n        \"project_name\": \"chapter11\",\n        \"runtime\": \"python3.6\",\n        \"s3_bucket\": \"zappa-ss0sm7k4r\",\n        \"remote_env\": \"s3://book-configs/chapter-11-config.json\",\n        \"vpc_config\": {\n \"SubnetIds\": [ \"subnet-1b10a072\", \"subnet-6303f22e\" ],\n \"SecurityGroupIds\": [ \"sg-892c4be0\" ]\n }\n    }\n}\n```", "```py\nzappa deploy command:\n```", "```py\n$ zappa deploy dev_vpc\nImportant! A new version of Zappa is available!\nUpgrade with: pip install zappa --upgrade\nVisit the project page on GitHub to see the latest changes: https://github.com/Miserlou/Zappa\nCalling deploy for stage dev_vpc..\nDownloading and installing dependencies..\n - lazy-object-proxy==1.3.1: Downloading\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 56.0K/56.0K [00:00<00:00, 4.88MB/s]\n - sqlite==python36: Using precompiled lambda package\nPackaging project as zip.\nUploading chapter11-dev-vpc-1532712120.zip (8.2MiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 8.65M/8.65M [00:03<00:00, 2.56MB/s]\nScheduling..\nScheduled chapter11-dev-vpc-zappa-keep-warm-handler.keep_warm_callback with expression rate(4 minutes)!\nUploading chapter11-dev-vpc-template-1532712136.json (1.6KiB)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1.64K/1.64K [00:00<00:00, 40.8KB/s]\nWaiting for stack chapter11-dev-vpc to create (this can take a bit)..\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 4/4 [00:09<00:00, 2.38s/res]\nDeploying API Gateway..\nDeployment complete!: https://6odti0061c.execute-api.ap-south-1.amazonaws.com/dev_vpc\n```"]